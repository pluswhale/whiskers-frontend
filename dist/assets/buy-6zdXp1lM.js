import{d as _,u as E,a as C,b as H,j as s,T as i,B as I,c as d,Y as u,e as r,f as U,J as F,g as Y,N as L,h as K,i as D,k as $,L as G,H as J}from"./index-B5IEmuoB.js";import{b as q}from"./back-arrow-BbeRbZMK.js";const Q="_buy__wrapper_1kl9d_1",X="_buy__back_1kl9d_10",Z="_buy__back_icon_1kl9d_19",V="_buy__container_1kl9d_23",ee="_buy__title_and_logo_1kl9d_30",se="_buy__title_1kl9d_30",te="_buy__heading_1kl9d_39",ne="_buy__buy_rows_1kl9d_47",oe="_buy__balance_1kl9d_52",re="_buy__balance_value_1kl9d_61",ae="_buy__footer_connect_1kl9d_67",_e="_buy__footer_connect_container_1kl9d_78",ie="_buy__footer_connect_score_1kl9d_85",ce="_buy__footer_connect_tokens_1kl9d_91",le="_buy__footer_connect_wallet_1kl9d_96",a={buy__wrapper:Q,buy__back:X,buy__back_icon:Z,buy__container:V,buy__title_and_logo:ee,buy__title:se,buy__heading:te,buy__buy_rows:ne,buy__balance:oe,buy__balance_value:re,buy__footer_connect:ae,buy__footer_connect_container:_e,buy__footer_connect_score:ie,buy__footer_connect_tokens:ce,buy__footer_connect_wallet:le},w=[{id:1,countSpins:100,countWhisks:3600},{id:2,countSpins:250,countWhisks:8900},{id:3,countSpins:500,countWhisks:17700},{id:4,countSpins:1e3,countWhisks:35200}],de="_buy_row__wrapper_en39z_1",ue="_buy_row__container_en39z_8",be="_buy_row__spins_en39z_13",ye="_buy_row__whisks_en39z_18",f={buy_row__wrapper:de,buy_row__container:ue,buy_row__spins:be,buy_row__whisks:ye};function pe(c){return _.beginCell().storeCoins(0).storeAddress(c.admin).storeRef(c.content).storeRef(c.walletCode).endCell()}class g{constructor(e,t){this.address=e,this.init=t}static createFromAddress(e){return new g(e)}static createFromConfig(e,t,o=0){const n=pe(e),l={code:t,data:n};return new g(_.contractAddress(o,l),l)}async sendDeploy(e,t,o){await e.internal(t,{value:o,sendMode:_.SendMode.PAY_GAS_SEPARATELY,body:_.beginCell().endCell()})}async sendMint(e,t,o,n,l,b){await e.internal(t,{sendMode:_.SendMode.PAY_GAS_SEPARATELY,body:_.beginCell().storeUint(21,32).storeUint(0,64).storeAddress(l).storeCoins(n).storeRef(_.beginCell().storeUint(395134233,32).storeUint(0,64).storeCoins(b).storeAddress(this.address).storeAddress(this.address).storeCoins(0).storeUint(0,1).endCell()).endCell(),value:o+n})}async getWalletAddressOf(e,t){return(await e.get("get_wallet_address",[{type:"slice",cell:_.beginCell().storeAddress(t).endCell()}])).stack.readAddress()}async getWalletCode(e){const t=(await e.get("get_jetton_data",[])).stack;return t.skip(4),t.readCell()}}const fe=c=>{const e=E({query:"(max-width: 600px)"}),{updateBonusSpins:t}=C(),[o]=H(),n=o.connected,{id:l,countSpin:b,countWhisk:h,userId:m,userTonAddress:y,jettonBalance:S}=c,j=async k=>{if(!y)d.error("Please connect TON wallet!",{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:u});else if(!n)d.error("Please connect TON Wallet!",{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:u});else if(S<h)d.error("Insufficient WHISK balance. Buy on STONfi.",{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:u});else if(m&&y){const A=r.toNano(h),v=r.Address.parse(U),N=r.Address.parse(y),T=r.beginCell().endCell(),B=r.toNano("0.01"),W=r.beginCell().endCell(),x=F.transferMessage(A,v,N,T,B,W),O=await Y({network:L}),M=new r.TonClient({endpoint:O}),P=new g(r.Address.parse(K)),R=await M.open(P).getWalletAddressOf(r.Address.parse(y)),z=r.toNano("0.05");try{await o.sendTransaction({messages:[{address:R.toString(),amount:z.toString(),payload:x==null?void 0:x.toBoc().toString("base64")}],validUntil:Date.now()+5*60*1e3});const p=await D(m,{countSpins:k});(p==null?void 0:p.status)===200?(t(k),d.success(`You bought ${k} spins`,{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:u})):d.error("Can't buy spins.",{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:u})}catch{d.error("User reject transaction",{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",transition:u})}}};return s.jsx("div",{className:f.buy_row__wrapper,children:s.jsxs("div",{className:f.buy_row__container,children:[s.jsxs("div",{className:f.buy_row__spins,children:[s.jsx(i,{fontSize:e?"26px":"50px",fontFamily:"Roundy Rainbows, sans-serif",children:b}),s.jsx(i,{fontSize:e?"16px":"24px",fontFamily:"Montserrat, sans-serif",children:"spins"})]}),s.jsxs("div",{className:f.buy_row__whisks,children:[s.jsx(i,{fontSize:e?"16px":"28px",fontFamily:"Montserrat, sans-serif",children:BigInt(h).toLocaleString()}),s.jsx(i,{fontSize:e?"16px":"26px",fontFamily:"Montserrat, sans-serif",children:"WHISK"})]}),s.jsx(I,{onClick:()=>j(b),fontFamily:"Montserrat, sans-serif",height:e?"28px":"52px",fontSize:e?"14px":"28px",boxShadow:"0px 2px 2px rgba(0, 0, 0, 0.1), inset 0px 1px 1px rgb(255 161 161 / 60%), inset 0px -3px 2px rgba(0, 0, 0, 0.2)",text:"Buy now",fontWeight:"normal",width:"fit-content",textTransform:"none",borderRadius:"24px"})]})},l)},ge=()=>{const c=$(),{userData:e,jettonBalance:t}=C(),o=()=>{c(-1)};return s.jsx("div",{className:a.buy__wrapper,children:s.jsxs("div",{className:a.buy__container,children:[s.jsxs("div",{className:a.buy__title_and_logo,children:[s.jsx(G,{fontSize:"42px"}),s.jsx("span",{className:a.buy__title,children:s.jsx(J,{className:a.buy__heading,level:"h1",children:"Spin&Earn"})})]}),s.jsx(i,{fontSize:"16px",fontFamily:"Montserrat, sans-serif",children:"Buy bonus spins with WHISK"}),s.jsx("div",{className:a.buy__buy_rows,children:w&&w.map(n=>s.jsx(fe,{id:n.id,countSpin:n.countSpins,countWhisk:n.countWhisks,userId:e==null?void 0:e.userId,userTonAddress:e==null?void 0:e.userTonAddress,jettonBalance:t},n.id))}),s.jsxs("div",{className:a.buy__balance,children:[s.jsxs("div",{onClick:o,className:a.buy__back,children:[s.jsx("img",{src:q,className:a.buy__back_icon,alt:"back to main screen"}),s.jsx(i,{children:"Back"})]}),s.jsxs("div",{className:a.buy__balance_value,children:[s.jsx(i,{fontSize:"14px",fontFamily:"Montserrat, sans-serif",children:"Wallet balance"}),s.jsxs(i,{fontSize:"16px",fontFamily:"Montserrat, sans-serif",children:[t.toLocaleString()," WHISK"]})]})]})]})})},me=()=>s.jsx(ge,{});export{me as default};
